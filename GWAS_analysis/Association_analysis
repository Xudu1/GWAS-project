-----------------------------------
title: "VCF_filtering_and_PCA"
author: "Megan McDonald"
date: "07/05/2020"
output: html_doccment
editor_options: 
  chunk_output_type: console
---------------------------------------------

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Using tassel to integrate SNP and phenotypic data of fungal isolates for GWAS analysis.

## The GLM model and MLM model were used to correlate the 20 cultivars separately



```{bash}
## Sorting the input genotype file using a plug-in
run_pipeline.pl -SortGenotypeFilePlugin -inputFile snp_2.vcf -outputFile snp_3 -fileType VCF

## Further conversion of the sorted vcf file to a heatmap file
run_pipeline.pl -fork1 -vcf snp_3.vcf  -export snp_4 -exportType Hapmap -runfork1

```



```{bash}
## TASSEL defines distance as 1-IBS (identity by state) similarity
## IBS is defined as the probability that two randomly selected individuals from the same locus have the same allele.
run_pipeline.pl -importGuess snp_4.hmp.txt -DistanceMatrixPlugin -endPlugin -export snp_4_genotype_distance.txt

## Create a kinship matrix based on IBS methord
run_pipeline.pl -importGuess snp_4.hmp.txt -KinshipPlugin -method Centered_IBS -endPlugin -export snp_kinship.txt -exportType SqrMatrix

## PCA analysis of genotype datasets
run_pipeline.pl -fork1 -importGuess chr4.hmp.txt -PrincipalComponentsPlugin -covariance true -endPlugin -export output -runfork1
```


```{bash}
## The following code shows only the GWAS analysis pepelines for the cultivars Arina and AUS4204, while the remaining cultivars share the same code

## Association analysis of Arina cultivars using general linear models, integrating distance matrices, PCA matrices and kinship matrices
run_pipeline.pl -fork1 -h snp_4.hmp.txt -filterAlign -filterAlignMinCount 150 -filterAlignMinFreq 0.05 -filterAlignMaxFreq 1 -fork2 -r Arina_phenotype.txt -fork3 -q snp_4.5.Q.txt -excludeLastTrait -combine4 -input1 -input2 -input3 -intersect -glm -export glm_GWAS

## Association analysis of Arina cultivars using mixed linear models, integrating distance matrices, PCA matrices and kinship matrices
run_pipeline.pl -fork1 -h snp_4.hmp.txt -filterAlign -filterAlignMinCount 150 -filterAlignMinFreq 0.05 -filterAlignMaxFreq 1 -fork2 -r  Arina_phenotype.txt -fork3 -q snp_4.5.Q.txt -excludeLastTrait -fork4 -k snp_kinship.txt -combine5 -input1 -input2 -input3 -intersect -combine6 -input5 -input4 -mlm -export mlm_GWAS


## Association analysis of AUS4204 cultivar based on GLM and MLM models
run_pipeline.pl -fork1 -h snp_4.hmp.txt -filterAlign -filterAlignMinCount 150 -filterAlignMinFreq 0.05 -filterAlignMaxFreq 1 -fork2 -r AUS4204_phenotype.txt -fork3 -q snp_4.5.Q.txt -excludeLastTrait -combine4 -input1 -input2 -input3 -intersect -glm -export glm_GWAS

run_pipeline.pl -fork1 -h snp_4.hmp.txt -filterAlign -filterAlignMinCount 150 -filterAlignMinFreq 0.05 -filterAlignMaxFreq 1 -fork2 -r AUS4204_phenotype.txt -fork3 -q snp_4.5.Q.txt -excludeLastTrait -fork4 -k snp_kinship.txt -combine5 -input1 -input2 -input3 -intersect -combine6 -input5 -input4 -mlm -export mlm_GWAS

```

